clear
clc
NA=[93	140	130	1.6
94	145	118	1.6
95	160	96	1.6
96	142.5	71	2.1
97	150	70	1.8
98	186	145	1.6
99	158	73.5	2.6
100	121	68	2.6
101	157	145	1.1
102	158	138.5	0.9
103	159	135	0.5
104	133	114	0.7
105	137.5	113	0.4
106	144	112	0.8
107	139	117	0.2
108	144.5	115	0.8
109	151	113	0.6
110	151.5	118	0.9
111	150	111	0.8
112	158	118	1.1
113	159	109	0.8
114	164	108.5	0.4
115	163	105	0.7
116	149	99.5	1.2
117	143	102	0.8
118	137	103	0.9
119	131	103	0.5
120	130	100	0.6
121	127	102	0.6
122	125	98	0.8
123	129	96	0.9
124	130	90	0.4
125	124	90	0.7
126	136	96	1.1
127	136	90	0.8
128	142	96	0.8
129	148	96	0.7
130	142	91	0.6
131	147	91	0.7
132	128	71	1.2
133	136.5	76	0.8
134	142	79	1.1
135	147	81	0.8
136	154	86	0.9
137	148.5	74.5	1.1
138	140	70	0.6
139	140	63	0.7
140	137.5	63	0.8
141	138	59	0.4
142	143	63	1.1
143	151	69	0.8
144	153	63	1.1
145	143	60	0.7
146	143	57	0.6
147	143	51.5	0.8
148	160	65	1.1
149	162	59	0.6
150	141	49	0.4
151	143	40	0.8
152	151	44	0.5
153	150	33	0.1
154	164	124	0.6
155	171	125	0.7
156	165.5	139	1.1
157	181	131	1.4
158	176	141	1.6
159	170	140	0.8
160	168	145	0.6
161	166	150	0.8
162	176	145	0.6
163	180	149	0.7
164	183	145	1.1
165	202	131	1.1
];%%A区路口节点.

EA=[12
14
16
21
22
23
24
28
29
30
38
48
62];

PA=[93
94
95
96
97
98
99
100
];

LA=[93	104
94	110
95	116
95	136
96	137
96	138
96	142
97	99
97	143
98	165
99	148
100	132
100	150
101	102
102	103
102	156
103	93
103	154
104	105
105	106
105	107
106	111
106	117
107	94
108	94
108	107
108	106
108	109
109	110
110	112
111	109
111	113
112	113
113	114
113	116
114	115
114	154
115	95
115	165
116	117
116	129
117	118
117	128
118	105
118	119
118	126
119	120
120	121
120	123
121	104
121	122
122	123
122	125
123	124
123	126
124	125
124	127
125	132
126	127
126	128
127	130
127	133
128	129
128	130
129	131
130	131
130	134
131	135
132	133
133	134
133	140
134	135
134	96
135	136
135	137
136	99
137	97
138	139
139	140
139	142
140	141
141	146
142	143
142	145
143	144
144	145
144	148
145	146
146	147
147	149
147	150
148	149
149	152
150	151
150	152
151	152
152	153
154	155
155	156
155	157
156	159
157	158
157	164
158	159
158	162
158	164
159	160
160	161
160	162
161	163
162	163
163	164
164	98
];

for i=1: length(NA);
for j=1: length(NA);
a(i,j)=inf;
end
end
for i=1: length(NA)
a(i,i)=0;
end
for i=1:length(LA)
x1=NA((LA(i,1)-92),2);%改
y1=NA((LA(i,1)-92),3);%改
x2=NA((LA(i,2)-92),2);%改
y2=NA((LA(i,2)-92),3);%改
plot([x1 x2],[y1 y2], '-')
hold on
d=((x2-x1)^2+(y2-y1)^2)^0.5;
a(LA(i,1)-92, LA(i,2)-92)=d;%改
a(LA(i,2)-92, LA(i,1)-92)=d;%改
end %% 画出A区交通路口的路线

[D,R]=floyd(a);
P=xlsread('BP');
VAR=10;
for i=1:length(P)
PA=PA(1:8);
p=P(i,:);
PA=[PA;p'];
S=D(:,PA-92);%改            %%S为结点与平台间距离矩阵
[min_S,index]=min(S,[],2);%%从S矩阵中找出每行的最小值以及对应的列数
no=[1: length(NA)] ;
No=no';              %%编号
data=[No,index,min_S];  %输出数据


A=[index,NA(:,4)];       %%最短平台与案发率
A1 = A(:,1);
A2 = A(:,2);
B1 = unique(A1);         %%B1为平台号
B2 = arrayfun(@(a)sum(A2(A1==a)),B1);%%B2为总案发率
B = [B1 B2];
if var(B2)<VAR
    VAR=var(B2)
    I=i
    
end
end